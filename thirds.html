<title>MTR.CSS - Hong Kong MTR Colors as CSS variables</title>
<link rel=stylesheet href=thirds-layout.css>
<link rel=stylesheet href=mtr.css>
<header>
  <h1>Please stand back from the doors.</h1>
</header>
<form>
  <a href=/index.html>Visit smalls view.</a>
  <button type=reset>Reset</button>
  <main>
  </main>
<form>
<footer>
  <h1>Thank you for travelling on the MTR.</h1>
  <p>
    <author>
      Site by <a href=https://github.com/crislin2046>Cris</a>. 
    </author>
    <a href=https://github.com/crislin2046/mtr.css>See the code</a>.
  <p class=disclaimer>
    This site is not affiliated with MTR Corp., HK, in any way.
  <p class=source>
    <cite>Colors are taken from the image shared in <a href=https://www.scmp.com/lifestyle/travel-leisure/article/2051751/why-every-hong-kong-mtr-station-different-colour-reason-may>this SCMP article from <time datetime="2017-07-13T17:43:00+08:00">July, 2017</time></a>
</footer>
<script>
  const mainElement = document.querySelector('main');
  const styleSheet = Array.from(document.styleSheets).find(({href}) => href.endsWith("mtr.css"));
  const styleRule = Array.from(styleSheet.rules).find(({selectorText}) => selectorText == ":root");
  const styleMap = (Array.from(styleRule.styleMap.entries()));
  console.log(styleMap);
  const colors = styleMap.reduce((C, [val, [color]]) => {
    C[val] = (color + '').trim();
    return C;
  },{});
  console.log(colors);
  for ( const stationName of Object.keys(colors) ) {
    const stationColor = colors[stationName];
    mainElement.insertAdjacentHTML('beforeEnd', `
      <label class="station color" style="background-color: ${stationColor}; outline: thin solid ${stationColor};">
        <input type=checkbox name=color-${stationName}>
        <p class=name>
          <span class=name>${titleCaseFromHyphenatedCSSVariable(stationName)}</span>
        <p class=color>
          <span class=color>${stationColor}</span>
      </label>
    `);
  }

  function titleCaseFromHyphenatedCSSVariable(str) {
    const words = str.split(/-/).filter(w => w.length);
    return words.join(' ');
  }
</script>
